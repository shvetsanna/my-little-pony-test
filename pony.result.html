 <!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî My Little Pony</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="app">
    <header class="top">
      <h1>–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h1>
      <p class="subtitle" id="resultSubtitle">...</p>
    </header>

    <section class="card result" id="resultCard">
      <div class="result__grid">
        <div>
          <h2 class="result__title" id="ponyName">...</h2>
          <p class="result__text" id="ponyDesc">...</p>

          <div class="badges">
            <div class="chip">Cutie Mark: <b id="markName">...</b></div>
            <div class="chip">–û—á–∫–∏: <b id="finalScore">0</b></div>
          </div>

          <div class="result__actions">
            <a class="btn" href="index.html" id="retry">–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</a>
            <button class="btn btn-ghost" id="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
          </div>
        </div>

        <div class="markBox">
          <div class="markBox__label">–¢–≤–æ–π cutie mark</div>
          <div id="markArt" class="markArt"></div>
        </div>
      </div>
    </section>

    <footer class="mini">
      <span>–§–æ–Ω –º–µ–Ω—è–µ—Ç—Å—è –ø–æ–¥ —Ç–≤–æ–π cutie mark üåà</span>
    </footer>
  </main>

  <script>
    const dataRaw = localStorage.getItem("mlp_result");
    const data = dataRaw ? JSON.parse(dataRaw) : null;

    const ponyName = document.getElementById("ponyName");
    const ponyDesc = document.getElementById("ponyDesc");
    const markName = document.getElementById("markName");
    const markArt = document.getElementById("markArt");
    const finalScore = document.getElementById("finalScore");
    const resultSubtitle = document.getElementById("resultSubtitle");

    const copyBtn = document.getElementById("copyBtn");

    const marks = {
      magic: { name: "–ú–∞–≥–∏—è", bg: "bg-magic", art: svgStar() },
      kindness: { name: "–î–æ–±—Ä–æ—Ç–∞", bg: "bg-kindness", art: svgHeart() },
      loyalty: { name: "–í–µ—Ä–Ω–æ—Å—Ç—å", bg: "bg-loyalty", art: svgRainbow() },
      laughter: { name: "–°–º–µ—Ö", bg: "bg-laughter", art: svgSmile() },
      honesty: { name: "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å", bg: "bg-honesty", art: svgApple() },
      creativity: { name: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", bg: "bg-creativity", art: svgPaint() },
    };

    if (!data) {
      ponyName.textContent = "–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞";
      ponyDesc.textContent = "–í–µ—Ä–Ω–∏—Å—å –Ω–∞ —Ç–µ—Å—Ç –∏ –ø—Ä–æ–π–¥–∏ –µ–≥–æ üôÇ";
      markName.textContent = "-";
      markArt.innerHTML = "";
      finalScore.textContent = "0";
      resultSubtitle.textContent = "–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–µ–Ω —Ç–µ—Å—Ç.";
    } else {
      ponyName.textContent = data.pony.name;
      ponyDesc.textContent = data.pony.desc;
      markName.textContent = marks[data.markKey]?.name ?? data.markKey;
      markArt.innerHTML = marks[data.markKey]?.art ?? "";
      finalScore.textContent = String(data.score);
      resultSubtitle.textContent = "–¢—ã —Å–∏—è–µ—à—å –ø–æ-—Å–≤–æ–µ–º—É ‚Äî –∏ —ç—Ç–æ —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞ ‚ú®";

      document.body.classList.add(marks[data.markKey]?.bg ?? "bg-magic");
    }

    copyBtn.addEventListener("click", async () => {
      const text = data
        ? `–ú–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${data.pony.name}. Cutie Mark: ${marks[data.markKey]?.name ?? data.markKey}. –û—á–∫–∏: ${data.score}`
        : "–Ø –µ—â—ë –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª(–∞) —Ç–µ—Å—Ç.";
      try {
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
        setTimeout(() => (copyBtn.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç"), 1200);
      } catch {
        alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –≤—Ä—É—á–Ω—É—é üôÇ");
      }
    });

    function svgBase(inner) {
      return `
        <svg viewBox="0 0 120 120" width="170" height="170" aria-hidden="true">
          <defs>
            <filter id="s" x="-20%" y="-20%" width="140%" height="140%">
              <feDropShadow dx="0" dy="6" stdDeviation="6" flood-opacity="0.25"/>
            </filter>
          </defs>
          <circle cx="60" cy="60" r="52" fill="rgba(255,255,255,0.9)" filter="url(#s)"/>
          ${inner}
        </svg>
      `;
    }
    function svgStar() {
      return svgBase(`<path d="M60 22l10 22 24 2-18 15 6 24-22-13-22 13 6-24-18-15 24-2z" fill="currentColor"/>`);
    }
    function svgHeart() {
      return svgBase(`<path d="M60 86s-28-16-28-36c0-10 8-18 18-18 6 0 10 3 10 3s4-3 10-3c10 0 18 8 18 18 0 20-28 36-28 36z" fill="currentColor"/>`);
    }
    function svgRainbow() {
      return svgBase(`
        <path d="M28 70a32 32 0 0164 0" fill="none" stroke="currentColor" stroke-width="10" stroke-linecap="round"/>
        <path d="M36 70a24 24 0 0148 0" fill="none" stroke="currentColor" stroke-width="7" stroke-linecap="round" opacity="0.7"/>
        <path d="M44 70a16 16 0 0132 0" fill="none" stroke="currentColor" stroke-width="5" stroke-linecap="round" opacity="0.45"/>
      `);
    }
    function svgSmile() {
      return svgBase(`
        <circle cx="45" cy="52" r="6" fill="currentColor"/>
        <circle cx="75" cy="52" r="6" fill="currentColor"/>
        <path d="M40 70c6 10 34 10 40 0" fill="none" stroke="currentColor" stroke-width="7" stroke-linecap="round"/>
      `);
    }
    function svgApple() {
      return svgBase(`
        <path d="M60 44c-18 0-26 10-26 24 0 18 14 30 26 30s26-12 26-30c0-14-8-24-26-24z" fill="currentColor"/>
        <path d="M64 28c8-10 18-8 18-8s-2 12-12 14" fill="none" stroke="currentColor" stroke-width="6" stroke-linecap="round"/>
        <path d="M54 26c0 8 6 14 6 14" fill="none" stroke="currentColor" stroke-width="6" stroke-linecap="round"/>
      `);
    }
    function svgPaint() {
      return svgBase(`
        <path d="M42 78c-10-10-10-26 0-36s26-10 36 0c8 8 9 20 3 30-2 3-2 6 1 9l2 2-10 10-2-2c-3-3-6-3-9-1-10 6-22 5-30-3z" fill="currentColor" opacity="0.9"/>
        <circle cx="55" cy="52" r="4" fill="#fff"/>
        <circle cx="68" cy="56" r="4" fill="#fff"/>
        <circle cx="57" cy="64" r="4" fill="#fff"/>
      `);
    }
  </script>
</body>
</html>
